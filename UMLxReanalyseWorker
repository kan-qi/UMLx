const umlModelInfoManager = require("./UMLModelInfoManagerMongoDB.js");
const umlEvaluator = require("./UMLEvaluator.js");


process.on("message", (repoId) => {
    umlModelInfoManager.queryFullRepoInfo(repoId, function(repoInfo){
        console.log("==================SURPRISE================");
        umlEvaluator.evaluateRepo(repoInfo, function(repoInfo){
            umlModelInfoManager.updateRepoInfo(repoInfo, function(){
                // counter = true;
                console.log("Finish All Calculation!");
                process.send('ok');
            });
        });
    });
});
