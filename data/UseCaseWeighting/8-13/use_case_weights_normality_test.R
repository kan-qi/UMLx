library(moments)

# testing difficult use case weights
DUCW <- c(15,
         18.95,
         15,
         16.84,
         16.84,
         14.19
)

summary(DUCW)
hist(DUCW)
mean(DUCW)
skewness(DUCW)
kurtosis(DUCW)

# testing average use case weights
AUCW <- c(10,
         10.24,
         7.66,
         7.66,
         10,
         8.49
)

summary(AUCW)
hist(AUCW)
mean(DUCW)
skewness(AUCW)
kurtosis(AUCW)

# testing simple use case weights

SUCWW <- c(5,
         5.93,
         5,
         5,
         5,
         5.81
)

summary(SUCWW)
hist(SUCWW)
mean(SUCWW)
skewness(SUCWW)
kurtosis(SUCWW)

# testing simple use cases

SUCW <- c(8,
         11,
         11,
         9,
         8,
         12,
         9,
         12,
         15,
         6,
         13,
         6,
         6,
         6,
         16,
         9,
         13,
         33,
         11,
         9,
         16,
         10,
         6,
         8,
         3,
         2,
         2,
         2,
         2,
         5,
         2,
         2,
         5,
         16
)

summary(SUCW)
hist(log(SUCW))
mean(SUCW)
skewness(log(SUCW))
kurtosis(log(SUCW))



#testing simple use cases

SUCW <- c(8,
          11,
          11,
          9,
          8,
          12,
          9,
          12,
          15,
          6,
          13,
          6,
          6,
          6,
          16,
          9,
          13,
          33,
          11,
          9,
          16,
          10,
          6,
          8,
          3,
          2,
          2,
          2,
          2,
          5,
          2,
          2,
          5,
          16
)

summary(SUCW)
hist(log(SUCW))
mean(SUCW)
skewness(log(SUCW))
kurtosis(log(SUCW))

#testing average use cases

AUC <- c(8,
          1,
          3,
          1,
          2,
          6,
          5,
          33,
          6,
          2,
          4,
          4,
          4,
          12,
          16,
          5,
          2,
          8,
          4,
          2,
          11,
          13,
          15,
          6,
          4,
          4,
          12,
          3,
          18,
          4,
          3,
          12,
          11,
          1
)

summary(AUC)
hist(AUC)
mean(AUC)
skewness(log(AUC))
kurtosis(log(AUC))

#normality test on internal dataset
useCaseData_internal <- read.csv("C:/Users/flyqk/Documents/Google Drive/ResearchSpace/Research Projects/UMLx/data/UseCaseWeighting/7-9/use_case_data_point.csv")

#useCaseData <- read.csv("C:/Users/flyqk/Documents/Google Drive/ResearchSpace/Research Projects/UMLx/data/UseCaseWeighting/7-9/UCP_Dataset_OnlineV1.0.csv")


lmodel1 <- lm(Real_Effort_Person_Hours~UCP, data=useCaseData_internal)
a <- summary(lmodel1)$coefficients[2,1]

useCaseData_internal$UUCP_Norm = useCaseData_internal$Real_Effort_Person_Hours/(a*useCaseData_internal$EF*useCaseData_internal$TCF) - useCaseData_internal$UAW


print(useCaseData_internal$Average_UC)

lmodel <- lm(useCaseData_internal$UUCP_Norm~Simple_UC+Complex_UC+Average_UC, data=useCaseData_internal)
summary(lmodel)
res<-resid(lmodel)
hist(res, main="internal_residual_distribution")
skewness(res)
kurtosis(res)

#normality test on external dataset

#useCaseData_external <- read.csv("C:/Users/flyqk/Documents/Google Drive/ResearchSpace/Research Projects/UMLx/data/UseCaseWeighting/7-9/use_case_data_point.csv")

useCaseData_external <- read.csv("C:/Users/flyqk/Documents/Google Drive/ResearchSpace/Research Projects/UMLx/data/UseCaseWeighting/7-9/UCP_Dataset_OnlineV1.0.csv")


lmodel1 <- lm(Real_Effort_Person_Hours~UCP, data=useCaseData_external)
a <- summary(lmodel1)$coefficients[2,1]

useCaseData_external$UUCP_Norm = useCaseData_external$Real_Effort_Person_Hours/(a*useCaseData_external$EF*useCaseData_external$TCF) - useCaseData_external$UAW


print(useCaseData_external$Average_UC)

lmodel <- lm(useCaseData_external$UUCP_Norm~Simple_UC+Complex_UC+Average_UC, data=useCaseData_external)
summary(lmodel)
res<-resid(lmodel)
hist(res, main="external_residual_distribution")
skewness(res)
kurtosis(res)

#normality test on mixed dataset

useCaseData_mixed <- useCaseData_internal
useCaseData_mixed <- rbind(useCaseData_mixed, useCaseData_external[,colnames(useCaseData_external) %in% colnames(useCaseData_internal)], stringsAsFactors=FALSE)

#useCaseData <- read.csv("C:/Users/flyqk/Documents/Google Drive/ResearchSpace/Research Projects/UMLx/data/UseCaseWeighting/7-9/UCP_Dataset_OnlineV1.0.csv")


lmodel1 <- lm(Real_Effort_Person_Hours~UCP, data=useCaseData_mixed)
a <- summary(lmodel1)$coefficients[2,1]

useCaseData_mixed$UUCP_Norm = useCaseData_mixed$Real_Effort_Person_Hours/(a*useCaseData_mixed$EF*useCaseData_mixed$TCF) - useCaseData_mixed$UAW


print(useCaseData_mixed$Average_UC)

lmodel <- lm(useCaseData_mixed$UUCP_Norm~Simple_UC+Complex_UC+Average_UC, data=useCaseData_mixed)
summary(lmodel)
res<-resid(lmodel)
hist(res, main="mixed_residual_distribution")
skewness(res)
kurtosis(res)
